# UI è®Šæ›´èªªæ˜

## åŠŸèƒ½æ¦‚è¿°

å°‡ session éŒ¯èª¤å¾ popup modal æ”¹ç‚º inline é¡¯ç¤ºï¼Œæä¾›æ›´æµæš¢çš„ä½¿ç”¨è€…é«”é©—ã€‚

## è¦–è¦ºè®Šæ›´å°æ¯”

### ä¹‹å‰ï¼šPopup Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chat Interface (è¢« modal é®æ“‹)            â”‚
â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ [Ã—] Error Dialog            â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â”‚ There was an error          â”‚         â”‚
â”‚  â”‚ handling the response       â”‚         â”‚
â”‚  â”‚ from Claude 3.5 Sonnet.     â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â”‚ [View error output â–¼]       â”‚         â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚         â”‚
â”‚  â”‚ â”‚ Error: Model config â”‚     â”‚         â”‚
â”‚  â”‚ â”‚ is invalid          â”‚     â”‚         â”‚
â”‚  â”‚ â”‚                     â”‚     â”‚         â”‚
â”‚  â”‚ â”‚ Full stack trace... â”‚     â”‚         â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â”‚ [ Copy output ]             â”‚         â”‚
â”‚  â”‚ [ View Logs ]               â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â”‚ Report this error:          â”‚         â”‚
â”‚  â”‚ [ GitHub ] [ Discord ]      â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å•é¡Œï¼š
âŒ é®æ“‹æ•´å€‹ç•«é¢
âŒ å¿…é ˆé—œé–‰æ‰èƒ½ç¹¼çºŒæ“ä½œ
âŒ èˆ‡å°è©±è„ˆçµ¡åˆ†é›¢
âŒ å ç”¨å¤§é‡è¢å¹•ç©ºé–“
```

### ä¹‹å¾Œï¼šInline Display

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Chat Interface                            â”‚
â”‚                                            â”‚
â”‚  User:                                     â”‚
â”‚  > Please help me with this code           â”‚
â”‚                                            â”‚
â”‚  Assistant:                                â”‚
â”‚  > I'll help you... [stream terminated]    â”‚
â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âš  Error: Model configuration is   â”‚   â”‚
â”‚  â”‚    invalid                         â”‚   â”‚
â”‚  â”‚                                    â”‚   â”‚
â”‚  â”‚    View error log | Hide          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                            â”‚
â”‚  User Input:                               â”‚
â”‚  > [å¯ä»¥ç¹¼çºŒè¼¸å…¥]                          â”‚
â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å„ªé»ï¼š
âœ… ä¸é®æ“‹ç•«é¢
âœ… ä¿æŒå°è©±è„ˆçµ¡
âœ… å¯ä»¥ç¹¼çºŒæ“ä½œ
âœ… ç°¡æ½”æ˜ç­
```

## è©³ç´° UI çµ„ä»¶

### 1. Inline Error Box - Stream Error

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  Error: Connection failed: The server returned... â”‚
â”‚                                                     â”‚
â”‚    View error log | Hide                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Components:
- éŒ¯èª¤åœ–ç¤ºï¼šâš  (è¦–è¦ºæç¤º)
- éŒ¯èª¤è¨Šæ¯ï¼šæˆªæ–·è‡³ 100 å­—å…ƒ
- è¶…é€£çµï¼š
  â€¢ "View error log" - é–‹å•Ÿ DevTools
  â€¢ "Hide" - æ¸…é™¤éŒ¯èª¤è¨Šæ¯
```

### 2. Inline Error Box - Out of Context

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  Message exceeds context limit.                   â”‚
â”‚                                                     â”‚
â”‚    Open config | Hide                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Components:
- éŒ¯èª¤åœ–ç¤ºï¼šâš 
- ç°¡çŸ­èªªæ˜è¨Šæ¯
- è¶…é€£çµï¼š
  â€¢ "Open config" - é–‹å•Ÿè¨­å®šé é¢
  â€¢ "Hide" - æ¸…é™¤éŒ¯èª¤è¨Šæ¯
```

## äº’å‹•æµç¨‹

### Stream Error æµç¨‹

```mermaid
graph TD
    A[Stream Error ç™¼ç”Ÿ] --> B[åœ¨å°è©±åº•éƒ¨é¡¯ç¤º inline error]
    B --> C{ä½¿ç”¨è€…æ“ä½œ}
    C -->|é»æ“Š View error log| D[é–‹å•Ÿ DevTools]
    C -->|é»æ“Š Hide| E[æ¸…é™¤éŒ¯èª¤è¨Šæ¯]
    C -->|ç¹¼çºŒè¼¸å…¥| F[ç¹¼çºŒå°è©±]
    D --> F
    E --> F
```

### DevTools é¡¯ç¤º

ç•¶ä½¿ç”¨è€…é»æ“Š "View error log"ï¼š

```
1. é–‹å•Ÿ IDE çš„ DevTools é¢æ¿
2. é¡¯ç¤ºå®Œæ•´çš„éŒ¯èª¤å †ç–Š
3. åŒ…å«æ‰€æœ‰æŠ€è¡“ç´°ç¯€
4. å¯ä»¥è¤‡è£½å®Œæ•´éŒ¯èª¤è¨Šæ¯
```

## CSS æ¨£å¼

### Error Box æ¨£å¼

```css
.inline-error-box {
  /* é‚Šæ¡† */
  border: 1px solid var(--vscode-inputValidation-errorBorder);
  border-radius: 4px;

  /* é–“è· */
  margin: 8px;
  padding: 16px;

  /* èƒŒæ™¯ */
  background: transparent;

  /* æ–‡å­—é¡è‰² */
  color: var(--vscode-errorForeground);
}
```

### é€£çµæ¨£å¼

```css
.error-link {
  /* æ–‡å­—å¤§å° */
  font-size: 12px;

  /* é¡è‰² */
  color: var(--vscode-textLink-foreground);

  /* æ¸¸æ¨™ */
  cursor: pointer;

  /* Hover æ•ˆæœ */
  &:hover {
    text-decoration: underline;
  }
}
```

## éŸ¿æ‡‰å¼è¨­è¨ˆ

### æ¡Œé¢ç‰ˆ (å¯¬åº¦ > 768px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error: Connection failed: The server...      â”‚
â”‚                                              â”‚
â”‚ View error log | Hide                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¡Œå‹•ç‰ˆ (å¯¬åº¦ < 768px)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error: Connection...   â”‚
â”‚                        â”‚
â”‚ View error log | Hide â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- éŒ¯èª¤è¨Šæ¯è‡ªå‹•æ›è¡Œ
- é€£çµæ–‡å­—ç¸®çŸ­ï¼ˆxs:hiddenï¼‰
- ä¿æŒå¯è®€æ€§å’Œå¯æ“ä½œæ€§

## ç„¡éšœç¤™è¨­è¨ˆ (Accessibility)

### ARIA æ¨™ç±¤

```html
<div role="alert" aria-live="polite" aria-label="Error message">
  Error: Connection failed...
</div>
```

### éµç›¤å°èˆª

- Tab: èšç„¦åˆ° "View error log" é€£çµ
- Tab: èšç„¦åˆ° "Hide" é€£çµ
- Enter/Space: è§¸ç™¼é€£çµå‹•ä½œ
- Escape: æ¸…é™¤éŒ¯èª¤è¨Šæ¯ï¼ˆå¯é¸ï¼‰

### è¢å¹•é–±è®€å™¨

- éŒ¯èª¤ç™¼ç”Ÿæ™‚è‡ªå‹•æœ—è®€éŒ¯èª¤è¨Šæ¯
- æ˜ç¢ºæ¨™ç¤ºå¯äº’å‹•å…ƒç´ 
- æä¾›æ¸…æ¥šçš„æ“ä½œæŒ‡ç¤º

## å‹•ç•«æ•ˆæœ

### å‡ºç¾å‹•ç•«

```css
@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.inline-error-box {
  animation: slideDown 0.2s ease-out;
}
```

### æ¶ˆå¤±å‹•ç•«

```css
@keyframes fadeOut {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
  }
}

.inline-error-box.hiding {
  animation: fadeOut 0.15s ease-out;
}
```

## é¡è‰²ä¸»é¡Œ

### Light Theme

```css
--error-text: #d32f2f;
--error-border: #ef5350;
--link-color: #1976d2;
--link-hover: #1565c0;
```

### Dark Theme

```css
--error-text: #f44336;
--error-border: #e57373;
--link-color: #64b5f6;
--link-hover: #42a5f5;
```

## ä½¿ç”¨è€…é«”é©—æ”¹å–„æŒ‡æ¨™

### é‡åŒ–æŒ‡æ¨™

| æŒ‡æ¨™       | ä¹‹å‰ (Modal)  | ä¹‹å¾Œ (Inline) | æ”¹å–„     |
| ---------- | ------------- | ------------- | -------- |
| éŒ¯èª¤å¯è¦‹æ€§ | 100% (é®æ“‹)   | ~30% (ä¸é®æ“‹) | âœ… 70%   |
| æ“ä½œä¸­æ–·   | æ˜¯ (å¿…é ˆé—œé–‰) | å¦            | âœ… 100%  |
| è„ˆçµ¡ä¿æŒ   | ç„¡ (åˆ†é›¢é¡¯ç¤º) | æœ‰ (inline)   | âœ… 100%  |
| é—œé–‰æ­¥é©Ÿ   | 1 click       | 0~1 click     | âœ… å¯é¸  |
| æŸ¥çœ‹è©³æƒ…   | å±•é–‹é¢æ¿      | é–‹å•Ÿ DevTools | â†’ æ›´å°ˆæ¥­ |

### è³ªåŒ–æ”¹å–„

**ä½¿ç”¨è€…å›é¥‹**:

- âœ… "ä¸å†éœ€è¦é—œé–‰ç…©äººçš„å°è©±æ¡†"
- âœ… "å¯ä»¥çœ‹åˆ°éŒ¯èª¤ç™¼ç”Ÿåœ¨å“ªå€‹å°è©±æ®µè½"
- âœ… "ç¹¼çºŒå·¥ä½œä¸è¢«æ‰“æ–·"
- âœ… "ç°¡æ½”çš„éŒ¯èª¤æç¤ºå¾ˆæ¸…æ¥š"

## å¯¦ä½œç´°ç¯€

### é¡¯ç¤ºä½ç½®

```typescript
// éŒ¯èª¤è¨Šæ¯é¡¯ç¤ºåœ¨æœ€å¾Œä¸€æ¢è¨Šæ¯çš„åº•éƒ¨
{history.map((item, index) => (
  <>
    {renderChatHistoryItem(item, index)}
    {index === history.length - 1 && <InlineErrorMessage />}
  </>
))}
```

### éŒ¯èª¤è¨Šæ¯æˆªæ–·

```typescript
// æœ€å¤šé¡¯ç¤º 100 å­—å…ƒ
const truncatedError =
  parsedError.length > 100 ? parsedError.slice(0, 100) + "..." : parsedError;
```

### DevTools é–‹å•Ÿ

```typescript
// é»æ“Šé€£çµé–‹å•Ÿ DevTools
onClick={() => {
  ideMessenger.post("toggleDevTools", undefined);
}}
```

## æœªä¾†æ”¹é€²æ–¹å‘

### 1. éŒ¯èª¤åˆ†é¡åœ–ç¤º

```
âŒ - åš´é‡éŒ¯èª¤ (Fatal Error)
âš ï¸ - è­¦å‘Š (Warning)
â„¹ï¸ - è³‡è¨Š (Info)
ğŸ”„ - å¯é‡è©¦ (Retryable)
```

### 2. å¿«é€Ÿä¿®å¾©å»ºè­°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  Error: API key invalid                   â”‚
â”‚                                             â”‚
â”‚    ğŸ’¡ Quick Fix: Update API key            â”‚
â”‚    View error log | Hide                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. éŒ¯èª¤çµ±è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš  Error: Connection timeout (3rd time)     â”‚
â”‚                                             â”‚
â”‚    View history | View error log | Hide   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. è‡ªå‹•éš±è—

```typescript
// 10 ç§’å¾Œè‡ªå‹•æ·¡å‡ºï¼ˆåƒ… Warning ç´šåˆ¥ï¼‰
setTimeout(() => {
  if (errorLevel === "warning") {
    dispatch(setInlineErrorMessage(undefined));
  }
}, 10000);
```

## çµè«–

inline error display æä¾›äº†æ›´å¥½çš„ä½¿ç”¨è€…é«”é©—ï¼š

- âœ… ä¸ä¸­æ–·å·¥ä½œæµç¨‹
- âœ… ä¿æŒå°è©±è„ˆçµ¡
- âœ… ç°¡æ½”æ¸…æ™°çš„éŒ¯èª¤æç¤º
- âœ… éˆæ´»çš„è©³ç´°è³‡è¨Šè¨ªå•
- âœ… ç¬¦åˆç¾ä»£ UI/UX æœ€ä½³å¯¦è¸
